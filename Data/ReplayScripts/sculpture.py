import math
import g

#local
def init_scene():
    g.set_use_camera_flight(True)
    g.set_duration(0.0)
    g.set_renderer("ClearView (Unified)")
    g.set_mesh("2012 - All-Hex Meshing using Singularity-Restricted Field", "sculpture/sculpture-B", "vtk")
    g.set_transfer_function("Standard.xml")
    g.set_camera_checkpoint("Video")
    g.set_rendering_algorithm_settings({
        "line_width": 0.0040,
        "lod_value_context": 0.3,
        "lod_value_focus": 0.3,
        "use_screen_space_lens": True,
        "screen_space_lens_radius": 0.0,
        "screen_space_lens_position": (10.5, 10.5),
        "focus_outline_width": 9.0,
        "clip_focus_outline": False,
        "focus_outline_color": (1.0, 0.0, 0.0),
        "important_lines": 0.644,
        "important_cells": 0.446,
    })

def length_vec2(v):
    return math.sqrt(v[0] * v[0] + v[1] * v[1])
def distance_vec2(v0, v1):
    return length_vec2((v0[0] - v1[0], v0[1] - v1[1]))

def move_lens_overview():
    lens_positions = [
        (0.12291666666666666, -0.615278),
        (0.12291666666666666, -0.615278),
        (0.12291666666666666, -0.615278),
        (0.25624666666666684, -0.615278),
        (0.22985666666666685, -0.615278),
        (0.25624666666666684, -0.615278),
        (0.28819666666666677, -0.598611),
        (0.3048566666666665, -0.586111),
        (0.3118066666666667, -0.577778),
        (0.3451366666666666, -0.565278),
        (0.4034766666666665, -0.568056),
        (0.422916666666667, -0.572222),
        (0.46319666666666703, -0.583333),
        (0.5173566666666665, -0.605556),
        (0.5423566666666668, -0.615278),
        (0.5423566666666668, -0.613889),
        (0.5423566666666668, -0.593056),
        (0.534026666666667, -0.573611),
        (0.5131966666666667, -0.431944),
        (0.5229166666666664, -0.204167),
        (0.5329166666666667, -0.00277776),
        (0.5429166666666668, 0.215278),
        (0.5379166666666666, 0.372222),
        (0.5329166666666667, 0.466667),
        (0.5179166666666665, 0.47),
        (0.5179166666666665, 0.47),
        (0.5179166666666665, 0.47),
        (0.4704166666666667, 0.47),
        (0.4470866666666666, 0.448611),
        (0.4118066666666664, 0.436111),
        (0.39652666666666664, 0.423611),
        (0.3937466666666666, 0.419444),
        (0.386806666666667, 0.409722),
        (0.28819666666666677, 0.351389),
        (0.0951386666666666, 0.273611),
        (-0.0756943333333333, 0.195833),
        (-0.12652733333333338, 0.138889),
        (-0.0673613333333334, 0.0833334),
        (0.041527666666666754, 0.0347222),
        (0.21208666666666684, 0.00833333),
        (0.40069666666666703, 0.00833333),
        (0.5520866666666667, 0.00972223),
        (0.6312466666666668, 0.00555551),
        (0.7184766666666668, 0),
        (0.792636666666667, 0),
        (0.807086666666667, 0.00416672),
        (0.8256966666666667, 0.0111111),
        (0.8270866666666664, 0.0111111),
        (0.8270866666666664, 0.0111111),
        (0.8256966666666667, 0.0125),
        (0.8229166666666666, 0.0138888),
        (0.8104166666666667, 0.0138888),
        (0.7159766666666665, -0.0388889),
        (0.6173566666666666, -0.0847222),
        (0.5534766666666668, -0.115278),
        (0.37569666666666673, -0.195833),
        (0.18402766666666664, -0.2875),
        (0.06736066666666653, -0.351389),
        (-0.010416333333333227, -0.4),
        (-0.04097233333333337, -0.433333),
        (-0.03680533333333326, -0.443056),
        (-0.014027333333333381, -0.472222),
        (0.03597266666666662, -0.474389),
        (0.0659726666666668, -0.476389)
    ]

    # Move lens to start position.
    g.set_duration(0)
    g.set_rendering_algorithm_settings({ "screen_space_lens_position": lens_positions[0] })
    g.set_rendering_algorithm_settings({ "screen_space_lens_radius": 360.0 })

    for i in range(1, len(lens_positions)):
        g.set_duration(0.5)
        g.set_rendering_algorithm_settings({ "screen_space_lens_position": lens_positions[i] })

def replay():
    init_scene()
    move_lens_overview()
